<!DOCTYPE html>
<html>
	<head>  
		<meta charset="UTF-8"> 
		<link rel="stylesheet" type="text/css" href="style.css" />
		<title>PicoBramble</title>

		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>  		
	</head>
	
	<body>
	
	<div id="menu">
		<a class="menu" href="index.html">
			<div class="menuitem">
				Home
			</div>
		</a>
		<a class="menu" href="nodes.html">
			<div class="menuitem">
				Nodes
			</div>
		</a>
		<a class="menu" href="jobs.html">
			<div class="menuitem">
				Jobs
			</div>
		</a>
		<a class="menu" href="docs.html">
			<div class="menuitem">
				Docs
			</div>
		</a>
		<a class="menu" href="about.html">
			<div class="menuitem">
				About
			</div>
		</a>
	</div>
	
	<div id="container">
		<h1>Bramble</h1>

		<script type="text/javascript">
			function updateTotalJobSlots(){
				$.ajax({ type: "GET",   
					url: "http://localhost:5802/api/total_job_slots",   
					async: true,
					success: function (result) {
						document.getElementById("total_job_slots").innerHTML = result;
					},
					error: function (data, textStatus, jqXHR){
						document.getElementById("total_job_slots").innerHTML = "Not available";
					}
				  }).responseText;
			}

			function updateAvailableJobSlots(){
				$.ajax({ type: "GET",   
					url: "http://localhost:5802/api/available_job_slots",   
					async: true,
					success: function (result) {
						document.getElementById("available_job_slots").innerHTML = result;
					},
					error: function (data, textStatus, jqXHR){
						document.getElementById("available_job_slots").innerHTML = "Not available";
					}
				  }).responseText;
			}
		</script>
		
		<table>
			<tr>
				<td>
				</td>
				<td>
					<h4>Total</h4>
				</td>
				<td>
					<h4>Available</h4>
				</td>
			</tr>
			
			<tr>
				<td>
					<h4>Job runners:</h4>
				</td>
				<td>
					<p id="total_job_slots">Not available</p>
				</td>
				<td>
					<p id="available_job_slots">Not available</p>
				</td>
			</tr>
		</table>
		
	</div>
	
	<script>
		function updateAll(){
			updateTotalJobSlots();
			updateAvailableJobSlots();
		}
		updateAll();
		setInterval(function(){updateAll()}, 2000);
		
	</script>

    </body>
</html>